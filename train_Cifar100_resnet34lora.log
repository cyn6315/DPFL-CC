nohup: ignoring input
cuda:4
Namespace(batch_size=2400, bn_sparsity=0.9, classes_per_user=20, clip_bound=1.8, clipping_style='all-layer', cluster_project_lr=0.06, cluster_temperature=1.0, dataset='CIFAR-100', dataset_dir='/home/chenyannan/fast-differential-privacy-main/examples/image_classification/data', downsample_lr=0.05, epochs=50, epsilon=8, feature_dim=128, global_lr=1.06, image_size=224, instance_project_lr=0.05, instance_temperature=0.5, kl_threshold=0.5, linear_sparsity=0.9, local_epoch=4, loss_KL=1, mini_bs=120, miu=0.05, model_path='save/Cifar-100-DPFL-ResNet18-iid', momentum=0.5, n_clients=25, num_class=20, r_conv=6, r_proj=16, reload=False, resnet='ResNet34_lora', resnet_lr=0.12, sample_ratio=1, seed=17, smooth_K=6, smooth_step=0, start_epoch=0, test_image_size=256, weight_decay=1e-05, workers=8)
len label: 60000
save/Cifar10/checkpoint_1000.tar
resnet.conv1.weight 9408 torch.Size([64, 3, 7, 7])
resnet.conv1.lora_A 882 torch.Size([42, 21])
resnet.conv1.lora_B 18816 torch.Size([448, 42])
resnet.bn1.weight 64 torch.Size([64])
resnet.bn1.bias 64 torch.Size([64])
resnet.layer1.0.conv1.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.0.conv1.lora_A 3456 torch.Size([18, 192])
resnet.layer1.0.conv1.lora_B 3456 torch.Size([192, 18])
resnet.layer1.0.bn1.weight 64 torch.Size([64])
resnet.layer1.0.bn1.bias 64 torch.Size([64])
resnet.layer1.0.conv2.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.0.conv2.lora_A 3456 torch.Size([18, 192])
resnet.layer1.0.conv2.lora_B 3456 torch.Size([192, 18])
resnet.layer1.0.bn2.weight 64 torch.Size([64])
resnet.layer1.0.bn2.bias 64 torch.Size([64])
resnet.layer1.1.conv1.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.1.bn1.weight 64 torch.Size([64])
resnet.layer1.1.bn1.bias 64 torch.Size([64])
resnet.layer1.1.conv2.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.1.bn2.weight 64 torch.Size([64])
resnet.layer1.1.bn2.bias 64 torch.Size([64])
resnet.layer1.2.conv1.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.2.bn1.weight 64 torch.Size([64])
resnet.layer1.2.bn1.bias 64 torch.Size([64])
resnet.layer1.2.conv2.weight 36864 torch.Size([64, 64, 3, 3])
resnet.layer1.2.bn2.weight 64 torch.Size([64])
resnet.layer1.2.bn2.bias 64 torch.Size([64])
resnet.layer2.0.conv1.weight 73728 torch.Size([128, 64, 3, 3])
resnet.layer2.0.conv1.lora_A 3456 torch.Size([18, 192])
resnet.layer2.0.conv1.lora_B 6912 torch.Size([384, 18])
resnet.layer2.0.bn1.weight 128 torch.Size([128])
resnet.layer2.0.bn1.bias 128 torch.Size([128])
resnet.layer2.0.conv2.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.0.conv2.lora_A 6912 torch.Size([18, 384])
resnet.layer2.0.conv2.lora_B 6912 torch.Size([384, 18])
resnet.layer2.0.bn2.weight 128 torch.Size([128])
resnet.layer2.0.bn2.bias 128 torch.Size([128])
resnet.layer2.0.downsample.0.weight 8192 torch.Size([128, 64, 1, 1])
resnet.layer2.0.downsample.0.lora_A 2304 torch.Size([36, 64])
resnet.layer2.0.downsample.0.lora_B 4608 torch.Size([128, 36])
resnet.layer2.0.downsample.1.weight 128 torch.Size([128])
resnet.layer2.0.downsample.1.bias 128 torch.Size([128])
resnet.layer2.1.conv1.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.1.bn1.weight 128 torch.Size([128])
resnet.layer2.1.bn1.bias 128 torch.Size([128])
resnet.layer2.1.conv2.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.1.bn2.weight 128 torch.Size([128])
resnet.layer2.1.bn2.bias 128 torch.Size([128])
resnet.layer2.2.conv1.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.2.bn1.weight 128 torch.Size([128])
resnet.layer2.2.bn1.bias 128 torch.Size([128])
resnet.layer2.2.conv2.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.2.bn2.weight 128 torch.Size([128])
resnet.layer2.2.bn2.bias 128 torch.Size([128])
resnet.layer2.3.conv1.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.3.bn1.weight 128 torch.Size([128])
resnet.layer2.3.bn1.bias 128 torch.Size([128])
resnet.layer2.3.conv2.weight 147456 torch.Size([128, 128, 3, 3])
resnet.layer2.3.bn2.weight 128 torch.Size([128])
resnet.layer2.3.bn2.bias 128 torch.Size([128])
resnet.layer3.0.conv1.weight 294912 torch.Size([256, 128, 3, 3])
resnet.layer3.0.conv1.lora_A 6912 torch.Size([18, 384])
resnet.layer3.0.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.0.bn1.weight 256 torch.Size([256])
resnet.layer3.0.bn1.bias 256 torch.Size([256])
resnet.layer3.0.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.0.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.0.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.0.bn2.weight 256 torch.Size([256])
resnet.layer3.0.bn2.bias 256 torch.Size([256])
resnet.layer3.0.downsample.0.weight 32768 torch.Size([256, 128, 1, 1])
resnet.layer3.0.downsample.0.lora_A 4608 torch.Size([36, 128])
resnet.layer3.0.downsample.0.lora_B 9216 torch.Size([256, 36])
resnet.layer3.0.downsample.1.weight 256 torch.Size([256])
resnet.layer3.0.downsample.1.bias 256 torch.Size([256])
resnet.layer3.1.conv1.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.1.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer3.1.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.1.bn1.weight 256 torch.Size([256])
resnet.layer3.1.bn1.bias 256 torch.Size([256])
resnet.layer3.1.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.1.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.1.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.1.bn2.weight 256 torch.Size([256])
resnet.layer3.1.bn2.bias 256 torch.Size([256])
resnet.layer3.2.conv1.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.2.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer3.2.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.2.bn1.weight 256 torch.Size([256])
resnet.layer3.2.bn1.bias 256 torch.Size([256])
resnet.layer3.2.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.2.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.2.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.2.bn2.weight 256 torch.Size([256])
resnet.layer3.2.bn2.bias 256 torch.Size([256])
resnet.layer3.3.conv1.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.3.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer3.3.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.3.bn1.weight 256 torch.Size([256])
resnet.layer3.3.bn1.bias 256 torch.Size([256])
resnet.layer3.3.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.3.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.3.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.3.bn2.weight 256 torch.Size([256])
resnet.layer3.3.bn2.bias 256 torch.Size([256])
resnet.layer3.4.conv1.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.4.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer3.4.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.4.bn1.weight 256 torch.Size([256])
resnet.layer3.4.bn1.bias 256 torch.Size([256])
resnet.layer3.4.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.4.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.4.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.4.bn2.weight 256 torch.Size([256])
resnet.layer3.4.bn2.bias 256 torch.Size([256])
resnet.layer3.5.conv1.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.5.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer3.5.conv1.lora_B 13824 torch.Size([768, 18])
resnet.layer3.5.bn1.weight 256 torch.Size([256])
resnet.layer3.5.bn1.bias 256 torch.Size([256])
resnet.layer3.5.conv2.weight 589824 torch.Size([256, 256, 3, 3])
resnet.layer3.5.conv2.lora_A 13824 torch.Size([18, 768])
resnet.layer3.5.conv2.lora_B 13824 torch.Size([768, 18])
resnet.layer3.5.bn2.weight 256 torch.Size([256])
resnet.layer3.5.bn2.bias 256 torch.Size([256])
resnet.layer4.0.conv1.weight 1179648 torch.Size([512, 256, 3, 3])
resnet.layer4.0.conv1.lora_A 13824 torch.Size([18, 768])
resnet.layer4.0.conv1.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.0.bn1.weight 512 torch.Size([512])
resnet.layer4.0.bn1.bias 512 torch.Size([512])
resnet.layer4.0.conv2.weight 2359296 torch.Size([512, 512, 3, 3])
resnet.layer4.0.conv2.lora_A 27648 torch.Size([18, 1536])
resnet.layer4.0.conv2.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.0.bn2.weight 512 torch.Size([512])
resnet.layer4.0.bn2.bias 512 torch.Size([512])
resnet.layer4.0.downsample.0.weight 131072 torch.Size([512, 256, 1, 1])
resnet.layer4.0.downsample.0.lora_A 9216 torch.Size([36, 256])
resnet.layer4.0.downsample.0.lora_B 18432 torch.Size([512, 36])
resnet.layer4.0.downsample.1.weight 512 torch.Size([512])
resnet.layer4.0.downsample.1.bias 512 torch.Size([512])
resnet.layer4.1.conv1.weight 2359296 torch.Size([512, 512, 3, 3])
resnet.layer4.1.conv1.lora_A 27648 torch.Size([18, 1536])
resnet.layer4.1.conv1.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.1.bn1.weight 512 torch.Size([512])
resnet.layer4.1.bn1.bias 512 torch.Size([512])
resnet.layer4.1.conv2.weight 2359296 torch.Size([512, 512, 3, 3])
resnet.layer4.1.conv2.lora_A 27648 torch.Size([18, 1536])
resnet.layer4.1.conv2.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.1.bn2.weight 512 torch.Size([512])
resnet.layer4.1.bn2.bias 512 torch.Size([512])
resnet.layer4.2.conv1.weight 2359296 torch.Size([512, 512, 3, 3])
resnet.layer4.2.conv1.lora_A 27648 torch.Size([18, 1536])
resnet.layer4.2.conv1.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.2.bn1.weight 512 torch.Size([512])
resnet.layer4.2.bn1.bias 512 torch.Size([512])
resnet.layer4.2.conv2.weight 2359296 torch.Size([512, 512, 3, 3])
resnet.layer4.2.conv2.lora_A 27648 torch.Size([18, 1536])
resnet.layer4.2.conv2.lora_B 27648 torch.Size([1536, 18])
resnet.layer4.2.bn2.weight 512 torch.Size([512])
resnet.layer4.2.bn2.bias 512 torch.Size([512])
instance_projector.0.weight 262144 torch.Size([512, 512])
instance_projector.0.bias 512 torch.Size([512])
instance_projector.2.weight 65536 torch.Size([128, 512])
instance_projector.2.bias 128 torch.Size([128])
cluster_projector2.0.weight 262144 torch.Size([512, 512])
cluster_projector2.0.bias 512 torch.Size([512])
cluster_projector2.2.weight 10240 torch.Size([20, 512])
cluster_projector2.2.bias 20 torch.Size([20])
sigma: 3.67919921875
Number of total parameters:  22634822
Number of trainable p  arameters:  1367174
### Creating features from model ###
Step [0/25]	 Computing features...
Global  NMI = 0.0055 ARI = 0.0014 F = 0.1732 ACC = 0.0507
